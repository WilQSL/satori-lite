version: '3.8'

# Local development docker-compose for satori-lite
#
# Production-like service:
#   docker compose -f docker-compose.local.yml up satori-lite
#
# Development service (live code mounts):
#   docker compose -f docker-compose.local.yml up satori-dev

services:
  # Production-like service (code baked into image)
  satori-lite:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: satori-lite
    environment:
      SATORI_CENTRAL_URL: http://satori-api:8000
      WALLET_PATH: /data/wallet.yaml
      VAULT_PATH: /data/vault.yaml
      SECRET_KEY: local-dev-secret-key-change-in-production
      WEB_PORT: 24601
    volumes:
      - ./data:/data
    ports:
      - "24601:24601"
    networks:
      - default
    command: python /Satori/Neuron/start.py

  # Development service (mounts code for live editing)
  satori-dev:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: satori-dev
    environment:
      SATORI_CENTRAL_URL: http://satori-api:8000
      WALLET_PATH: /data/wallet.yaml
      VAULT_PATH: /data/vault.yaml
      SECRET_KEY: local-dev-secret-key-change-in-production
      WEB_PORT: 24601
      MUNDO_URL: https://mundo.satorinet.io
    volumes:
      # Persist wallet data
      - ./data:/data
      # Mount satorilib for live editing
      - ../satorilib/src:/Satori/Lib
      # Mount neuron code
      - ./neuron-lite:/Satori/Neuron
      - ./engine-lite:/Satori/Engine
      - ./web:/Satori/web
      - ./tests:/Satori/tests
    ports:
      - "24601:24601"
    networks:
      - default
    command: python /Satori/Neuron/start.py

networks:
  default:
    name: app_default
    external: true
